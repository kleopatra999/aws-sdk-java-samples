<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<codeSamples>
<sample description="This example returns information about a specified job, including the status of that job if it exists. This is only used for job workers and custom actions in AWS CodePipeline. To determine the value of nonce and the job ID, use PollForJobs." id="AcknowledgeJob" title="Acknowledge a job for a custom action">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
AcknowledgeJobRequest request = new AcknowledgeJobRequest()
//Use the PollforJobs API to determine the ID of the job.
        .withJobId("11111111-abcd-1111-abcd-111111abcdef")//Use the PollforJobs API to determine the nonce for the job.
        .withNonce("3");
AcknowledgeJobResult response = client.acknowledgeJob(request);</content>
</sample>
<sample description="This example creates a build custom action for AWS CodePipeline for a Jenkins build project. For more information about the requirements for creating a custom action, including the structure of the JSON file commonly used to help create custom actions, see Create a Custom Action in the AWS CodePipeline User Guide. For a walkthrough of creating a custom action in a pipeline, follow the Four-Stage Pipeline Tutorial." id="CreateCustomActionType" title="Create a custom action">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
CreateCustomActionTypeRequest request = new CreateCustomActionTypeRequest()
        //A new custom action always has a version of 1. This is required.
        .withVersion("1")
        .withCategory("Build")
        //The text in description will be displayed to your users, and can contain a maximum of 2048 characters. The value for name in configurationProperties is the name of the project, if any.  In this example, this is the name of the build project on the Jenkins server
        .withConfigurationProperties(
                new ActionConfigurationProperty()
                        .withName("MyJenkinsExampleBuildProject")
                        .withType("String")
                        .withRequired(true)
                        .withKey(true)
                        .withDescription(
                                "The name of the build project must be provided when this action is added to the pipeline.")
                        .withQueryable(false).withSecret(false))
        //This is the minimum and maximum number of artifacts allowed as inputs for the action. For more information about input and output artifacts, see Pipeline Structure Reference in the AWS CodePipeline User Guide.
        .withInputArtifactDetails(
                new ArtifactDetails().withMaximumCount(1)
                        .withMinimumCount(0))//This is the minimum and maximum number of artifacts allowed as outputs for the action. For more information about input and output artifacts, see Pipeline Structure Reference in the AWS CodePipeline User Guide.
        .withOutputArtifactDetails(
                new ArtifactDetails().withMaximumCount(1)
                        .withMinimumCount(0))//In this example, this is the name given to the provider field when configuring the AWS CodePipeline Plugin for Jenkins. For more information, see the Four-Stage Pipeline Tutorial in the AWS CodePipeline User Guide.
        .withProvider("MyBuild-ProviderName")//entityUrlTemplate is the static link that provides information about the service provider for the action. In the example, the build system includes a static link to the Jenkins build project at the specific server address.  Similarly, executionUrlTemplate is the dynamic link that will be updated with information about the current or most recent run of the action.
        .withSettings(
                new ActionTypeSettings()
                        .withEntityUrlTemplate(
                                "https://192.0.2.4/job/{Config:ProjectName}/")
                        .withExecutionUrlTemplate(
                                "https://192.0.2.4/job/{Config:ProjectName}/lastSuccessfulBuild/{ExternalExecutionId}/")
                        .withRevisionUrlTemplate("none"));
CreateCustomActionTypeResult response = client
        .createCustomActionType(request);</content>
</sample>
<sample description="This example creates a simple two-stage pipeline in AWS CodePipeline that uses an Amazon S3 bucket for its source stage and deploys code using AWS CodeDeploy. For more information about the requirements for creating a pipeline, including the structure of the JSON file commonly used to create a pipeline, see &quot;Create a Pipeline&quot; in the AWS CodePipeline User Guide." id="CreatePipeline" title="Create a pipeline">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
CreatePipelineRequest request = new CreatePipelineRequest()
        .withPipeline(new PipelineDeclaration()
                .withVersion(1)
                .withName("MySecondPipeline")
                .withArtifactStore(
                        new ArtifactStore()
                                .withType("S3")
                                .withLocation(
                                        "codepipeline-us-east-1-11EXAMPLE11"))
                .withRoleArn(
                        "arn:aws:iam::111111111111:role/AWS-CodePipeline-Service")
                .withStages(
                        new StageDeclaration()
                                .withName("Source")
                                .withActions(
                                        new ActionDeclaration()
                                                .withName("Source")
                                                .withActionTypeId(
                                                        new ActionTypeId()
                                                                .withVersion(
                                                                        "1")
                                                                .withCategory(
                                                                        "Source")
                                                                .withOwner(
                                                                        "AWS")
                                                                .withProvider(
                                                                        "S3"))
                                                .addConfigurationEntry(
                                                        "S3Bucket",
                                                        "awscodepipeline-demo-bucket")
                                                .addConfigurationEntry(
                                                        "S3ObjectKey",
                                                        "aws-codepipeline-s3-aws-codedeploy_linux.zip")
                                                .withInputArtifacts()
                                                .withOutputArtifacts(
                                                        new OutputArtifact()
                                                                .withName("MyApp"))
                                                .withRunOrder(1)),
                        new StageDeclaration()
                                .withName("Beta")
                                .withActions(
                                        new ActionDeclaration()
                                                .withName(
                                                        "CodePipelineDemoFleet")
                                                .withActionTypeId(
                                                        new ActionTypeId()
                                                                .withVersion(
                                                                        "1")
                                                                .withCategory(
                                                                        "Deploy")
                                                                .withOwner(
                                                                        "AWS")
                                                                .withProvider(
                                                                        "CodeDeploy"))
                                                .addConfigurationEntry(
                                                        "ApplicationName",
                                                        "CodePipelineDemoApplication")
                                                .addConfigurationEntry(
                                                        "DeploymentGroupName",
                                                        "CodePipelineDemoFleet")
                                                .withInputArtifacts(
                                                        new InputArtifact()
                                                                .withName("MyApp"))
                                                .withOutputArtifacts()
                                                .withRunOrder(1))));
CreatePipelineResult response = client.createPipeline(request);</content>
</sample>
<sample description="This example deletes a custom action in AWS CodePipeline by specifiying the action type, provider name, and version number of the action to be deleted. Only used for custom actions. Use the list-action-types command to view the correct values for category, version, and provider. After a custom action is deleted, PollForJobs for the custom action will fail. Warning: You cannot recreate a custom action after it has been deleted unless you increase the version number of the action." id="DeleteCustomActionType" title="Delete a custom action">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
DeleteCustomActionTypeRequest request = new DeleteCustomActionTypeRequest()
//This is the current version number of the custom action.
        .withVersion("1")//This is the type of action that the custom action is, for example build or test.
        .withCategory("Build")//This is the provider of the service used in the custom action. In this example, the custom action is for a Jenkins build, and the name of the provider is the one configured in the AWS CodePipeline Plugin for Jenkins
        .withProvider("MyJenkinsProviderName");
DeleteCustomActionTypeResult response = client
        .deleteCustomActionType(request);</content>
</sample>
<sample description="This example deletes a pipeline named MySecondPipeline from AWS CodePipeline. Use ListPipelines to view a list of pipelines associated with your AWS account." id="DeletePipeline" title="Delete a pipeline">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
DeletePipelineRequest request = new DeletePipelineRequest()
//The name of the pipeline to delete.
        .withName("MySecondPipeline");
DeletePipelineResult response = client.deletePipeline(request);</content>
</sample>
<sample description="This example disables transitions into the Beta stage of the MyFirstPipeline pipeline in AWS CodePipeline." id="DisableStageTransition" title="Disable transitions into or out of a stage">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
DisableStageTransitionRequest request = new DisableStageTransitionRequest()
        .withPipelineName("MyFirstPipeline")
        .withReason("An example reason").withStageName("Beta")//Valid values are Inbound, which prevents artifacts from transitioning into the stage and being processed by the actions in that stage, or Outbound, which prevents artifacts from transitioning out of the stage after they have been processed by the actions in that stage.
        .withTransitionType("Inbound");
DisableStageTransitionResult response = client
        .disableStageTransition(request);</content>
</sample>
<sample description="This example enables transitions into the Beta stage of the MyFirstPipeline pipeline in AWS CodePipeline." id="EnableStageTransition" title="Enable transitions into or out of a stage">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
EnableStageTransitionRequest request = new EnableStageTransitionRequest()
        .withPipelineName("MyFirstPipeline").withStageName("Beta")//Valid values are Inbound, which allows artifacts to transition into the stage and be processed by the actions in that stage, or Outbound, which allows artifacts to transition out of the stage after they have been processed by the actions in that stage.
        .withTransitionType("Inbound");
EnableStageTransitionResult response = client
        .enableStageTransition(request);</content>
</sample>
<sample description="This example returns details about a job whose ID is represented by f4f4ff82-2d11-EXAMPLE. This command is only used for custom actions. When this command is called, AWS CodePipeline returns temporary credentials for the Amazon S3 bucket used to store artifacts for the pipeline, if required for the custom action. This command will also return any secret values defined for the action, if any are defined." id="GetJobDetails" title="Get the details of a job">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
GetJobDetailsRequest request = new GetJobDetailsRequest()
        .withJobId("11111111-abcd-1111-abcd-111111abcdef");
GetJobDetailsResult response = client.getJobDetails(request);</content>
</sample>
<sample description="This example returns the structure of a pipeline named MyFirstPipeline." id="GetPipeline" title="View the structure of a pipeline">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
GetPipelineRequest request = new GetPipelineRequest()
//This is an optional parameter. If you do not specify a version, the most current version of the pipeline structure is returned.
        .withVersion(123).withName("MyFirstPipeline");
GetPipelineResult response = client.getPipeline(request);</content>
</sample>
<sample description="This example returns the most recent state of a pipeline named MyFirstPipeline." id="GetPipelineState" title="View information about the state of a pipeline">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
GetPipelineStateRequest request = new GetPipelineStateRequest()
        .withName("MyFirstPipeline");
GetPipelineStateResult response = client.getPipelineState(request);</content>
</sample>
<sample description="Used by itself, ListActionTypes returns the structure of all AWS CodePipeline actions available to your AWS account. This example uses the actionOwnerFilter option to limit the response to include only the structure of all custom actions defined for the account." id="ListActionTypes" title="View a summary of all action types associated with your account">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
ListActionTypesRequest request = new ListActionTypesRequest()
        .withActionOwnerFilter("Custom").withNextToken("");
ListActionTypesResult response = client.listActionTypes(request);</content>
</sample>
<sample description="This example lists all AWS CodePipeline pipelines associated with the user's AWS account." id="ListPipelines" title="View a summary of all pipelines associated with your account">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
ListPipelinesRequest request = new ListPipelinesRequest();
ListPipelinesResult response = client.listPipelines(request);</content>
</sample>
<sample description="This example returns information about any jobs for a job worker to act upon. This command is only used for custom actions. When this command is called, AWS CodePipeline returns temporary credentials for the Amazon S3 bucket used to store artifacts for the pipeline. This command will also return any secret values defined for the action, if any are defined." id="PollForJobs" title="View any available jobs">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
PollForJobsRequest request = new PollForJobsRequest()
        .withActionTypeId(
                new ActionTypeId().withVersion("1")
                        .withCategory("Test").withOwner("Custom")
                        .withProvider("MyJenkinsProviderName"))
        .withMaxBatchSize(5)
        .addQueryParamEntry("ProjectName", "MyJenkinsTestProj");
PollForJobsResult response = client.pollForJobs(request);</content>
</sample>
<sample description="This example runs the latest revision present in the source stage of a pipeline through the pipeline named &quot;MyFirstPipeline&quot;." id="StartPipelineExecution" title="Run the latest revision through a pipeline">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
StartPipelineExecutionRequest request = new StartPipelineExecutionRequest()
        .withName("MyFirstPipeline");
StartPipelineExecutionResult response = client
        .startPipelineExecution(request);</content>
</sample>
<sample description="This example updates the structure of a pipeline. The entire structure of the pipeline must be supplied, either by passing all of the parameters, or by using a pre-defined JSON file." id="UpdatePipeline" title="Update the structure of a pipeline">
<content>AWSCodePipeline client = new AWSCodePipelineClient();
UpdatePipelineRequest request = new UpdatePipelineRequest()
        .withPipeline(new PipelineDeclaration()
                .withVersion(2)
                .withName("MyFirstPipeline")
                .withArtifactStore(
                        new ArtifactStore()
                                .withType("S3")
                                .withLocation(
                                        "codepipeline-us-east-1-11EXAMPLE11"))
                .withRoleArn(
                        "arn:aws:iam::111111111111:role/AWS-CodePipeline-Service")
                .withStages(
                        new StageDeclaration()
                                .withName("Source")
                                .withActions(
                                        new ActionDeclaration()
                                                .withName("Source")
                                                .withActionTypeId(
                                                        new ActionTypeId()
                                                                .withVersion(
                                                                        "1")
                                                                .withCategory(
                                                                        "Source")
                                                                .withOwner(
                                                                        "AWS")
                                                                .withProvider(
                                                                        "S3"))
                                                .addConfigurationEntry(
                                                        "S3Bucket",
                                                        "awscodepipeline-demo-bucket2")
                                                .addConfigurationEntry(
                                                        "S3ObjectKey",
                                                        "aws-codepipeline-s3-aws-codedeploy_linux.zip")
                                                .withInputArtifacts()
                                                .withOutputArtifacts(
                                                        new OutputArtifact()
                                                                .withName("MyApp"))
                                                .withRunOrder(1)),
                        new StageDeclaration()
                                .withName("Beta")
                                .withActions(
                                        new ActionDeclaration()
                                                .withName(
                                                        "CodePipelineDemoFleet")
                                                .withActionTypeId(
                                                        new ActionTypeId()
                                                                .withVersion(
                                                                        "1")
                                                                .withCategory(
                                                                        "Deploy")
                                                                .withOwner(
                                                                        "AWS")
                                                                .withProvider(
                                                                        "CodeDeploy"))
                                                .addConfigurationEntry(
                                                        "ApplicationName",
                                                        "CodePipelineDemoApplication")
                                                .addConfigurationEntry(
                                                        "DeploymentGroupName",
                                                        "CodePipelineDemoFleet")
                                                .withInputArtifacts(
                                                        new InputArtifact()
                                                                .withName("MyApp"))
                                                .withOutputArtifacts()
                                                .withRunOrder(1))));
UpdatePipelineResult response = client.updatePipeline(request);</content>
</sample>
</codeSamples>
